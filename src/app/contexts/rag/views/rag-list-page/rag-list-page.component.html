<div class="rag-list-page">
  <!-- Header -->
  <div class="page-header mb-4">
    <div class="flex justify-content-between align-items-center">
      <div>
        <h1 class="m-0 mb-2">Base de Conocimiento RAG</h1>
        <p class="text-gray-600 m-0">Gestión de documentos, chunks y búsqueda semántica</p>
      </div>
      <p-button label="Subir documento" icon="pi pi-upload" severity="success" (onClick)="openUploadDialog()"></p-button>
    </div>
  </div>

  <!-- Tabs -->
  <p-tabView>
    <!-- Tab: Documentos -->
    <p-tabPanel header="Documentos">
      <ng-template pTemplate="header">
        <div class="flex align-items-center gap-2">
          <i class="pi pi-file"></i>
          <span>Documentos</span>
          <p-badge [value]="documents.length" severity="info"></p-badge>
        </div>
      </ng-template>

      <div class="tab-content">
        <app-document-table [documents]="documents" (retryIngestion)="onRetryIngestion($event)" (deleteDocument)="onDeleteDocument($event)"></app-document-table>
      </div>
    </p-tabPanel>

    <!-- Tab: Búsqueda RAG -->
    <p-tabPanel header="Búsqueda RAG">
      <ng-template pTemplate="header">
        <div class="flex align-items-center gap-2">
          <i class="pi pi-search"></i>
          <span>Búsqueda RAG</span>
        </div>
      </ng-template>

      <div class="tab-content">
        <app-rag-search></app-rag-search>
      </div>
    </p-tabPanel>

    <!-- Tab: Estadísticas -->
    <p-tabPanel header="Estadísticas">
      <ng-template pTemplate="header">
        <div class="flex align-items-center gap-2">
          <i class="pi pi-chart-bar"></i>
          <span>Estadísticas</span>
        </div>
      </ng-template>

      <div class="tab-content">
        <div class="grid">
          <div class="col-12 md:col-6 lg:col-3">
            <p-card>
              <div class="stat-card">
                <i class="pi pi-file text-primary text-4xl mb-3"></i>
                <div class="stat-value">{{ stats.totalDocuments }}</div>
                <div class="stat-label">Total Documentos</div>
              </div>
            </p-card>
          </div>

          <div class="col-12 md:col-6 lg:col-3">
            <p-card>
              <div class="stat-card">
                <i class="pi pi-check-circle text-green-500 text-4xl mb-3"></i>
                <div class="stat-value">{{ stats.completedDocuments }}</div>
                <div class="stat-label">Completados</div>
              </div>
            </p-card>
          </div>

          <div class="col-12 md:col-6 lg:col-3">
            <p-card>
              <div class="stat-card">
                <i class="pi pi-spin pi-spinner text-orange-500 text-4xl mb-3"></i>
                <div class="stat-value">{{ stats.processingDocuments }}</div>
                <div class="stat-label">Procesando</div>
              </div>
            </p-card>
          </div>

          <div class="col-12 md:col-6 lg:col-3">
            <p-card>
              <div class="stat-card">
                <i class="pi pi-database text-blue-500 text-4xl mb-3"></i>
                <div class="stat-value">{{ stats.totalChunks }}</div>
                <div class="stat-label">Total Chunks</div>
              </div>
            </p-card>
          </div>
        </div>
      </div>
    </p-tabPanel>
  </p-tabView>

  <!-- Upload dialog -->
  <app-document-upload #uploadDialog (uploadComplete)="onUploadComplete()"></app-document-upload>

  <p-toast></p-toast>
</div>
