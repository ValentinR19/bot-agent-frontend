<div class="catalog-list-page">
  <p-card>
    <ng-template pTemplate="header">
      <div class="flex justify-content-between align-items-center p-3">
        <h2>Gestión de Catálogo</h2>
        <p-button label="Nuevo Item" icon="pi pi-plus" (onClick)="goToCreate()"></p-button>
      </div>
    </ng-template>

    <p-table
      [value]="items"
      [loading]="loading"
      [paginator]="true"
      [rows]="10"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} items"
      [rowsPerPageOptions]="[10, 25, 50]"
      [globalFilterFields]="['title', 'sku', 'type']"
      #dt
    >
      <ng-template pTemplate="caption">
        <div class="flex">
          <span class="p-input-icon-left ml-auto">
            <i class="pi pi-search"></i>
            <input pInputText type="text" (input)="dt.filterGlobal($any($event.target).value, 'contains')" placeholder="Buscar..." />
          </span>
        </div>
      </ng-template>

      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="title">Título <p-sortIcon field="title"></p-sortIcon></th>
          <th>SKU</th>
          <th pSortableColumn="type">Tipo <p-sortIcon field="type"></p-sortIcon></th>
          <th pSortableColumn="price">Precio <p-sortIcon field="price"></p-sortIcon></th>
          <th>Stock</th>
          <th>Destacado</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-item>
        <tr>
          <td>{{ item.title }}</td>
          <td>
            <span class="font-semibold">{{ item.sku || '-' }}</span>
          </td>
          <td>
            <span class="badge badge-type">{{ getTypeLabel(item.type) }}</span>
          </td>
          <td>{{ item.price ? (item.price | number: '1.2-2') + ' ' + item.currency : '-' }}</td>
          <td>{{ item.stock !== undefined ? item.stock : '-' }}</td>
          <td>
            <span [class]="'badge ' + (item.isFeatured ? 'badge-warning' : 'badge-secondary')">
              {{ item.isFeatured ? 'Sí' : 'No' }}
            </span>
          </td>
          <td>
            <span [class]="'badge ' + (item.isActive ? 'badge-success' : 'badge-danger')">
              {{ item.isActive ? 'Activo' : 'Inactivo' }}
            </span>
          </td>
          <td>
            <div class="flex gap-2">
              <p-button icon="pi pi-eye" [rounded]="true" [text]="true" severity="info" (onClick)="goToDetail(item.id)" pTooltip="Ver detalle"></p-button>
              <p-button icon="pi pi-pencil" [rounded]="true" [text]="true" severity="warn" (onClick)="goToEdit(item.id)" pTooltip="Editar"></p-button>
              <p-button icon="pi pi-trash" [rounded]="true" [text]="true" severity="danger" (onClick)="confirmDelete(item)" pTooltip="Eliminar"></p-button>
            </div>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="8" class="text-center">No se encontraron items en el catálogo.</td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>

  <p-confirmDialog></p-confirmDialog>
  <p-toast></p-toast>
</div>
